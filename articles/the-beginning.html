<!DOCTYPE html><html><head><meta charset="utf-8" /><meta name="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.css" /><link rel="stylesheet" href="/static/css/style_c68de8e5aafce1452e37d2687a1dc351.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" crossorigin="anonymous" /><title>How to write a website generator in Scala, Part 1 | bishabosha</title><meta name="description" content="Introduction to using Scala CLI as a tool to aid generating a personal website, and a description of the framework used." /><meta name="twitter:card" content="summary" /><meta name="twitter:title" content="How to write a website generator in Scala, Part 1 | bishabosha" /><meta name="twitter:site" content="@bishabosha" /><meta name="twitter:description" content="Introduction to using Scala CLI as a tool to aid generating a personal website, and a description of the framework used." /><meta name="og:title" content="How to write a website generator in Scala, Part 1 | bishabosha" /><meta name="og:description" content="Introduction to using Scala CLI as a tool to aid generating a personal website, and a description of the framework used." /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" /><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js" type="text/javascript"></script><link rel="stylesheet" href="/static/css/admonition_972c50a2320249eebf61150270d503dc.css" /></head><body class="d-flex flex-column min-vh-100"><nav class="navbar navbar-expand-md navbar-light fixed-top bg-light"><div class="container-fluid"><a class="navbar-brand navbar-slash" href="/">bishabosha</a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"><a class="nav-link" href="/about/">About</a></li><li class="nav-item"><a class="nav-link active" aria-current="page" href="/articles/">Articles</a></li><li class="nav-item"><a class="nav-link" href="/projects/">Projects</a></li><li class="nav-item"><a class="nav-link" href="/talks/">Talks</a></li></ul></div></div></nav><div class="container"><div class="row"><div class="col-lg-4"><div class="bio-box jumbotron sidebar shadow py-lg-4 py-3 bio-box__top"><div class="bio-main"><table><tr><td class="bio-left"><div class="bio-photo"><img src="/static/img/jamie_thompson_profile.png" alt="photo of bishabosha" class="img-avatar" /></div></td><td class="bio-right"><p><span class="bio-name">Jamie Thompson</span></p></td></tr></table><ul class="list-inline"><li class="list-inline-item"><p class="text-center mb-1"><small><a href="https://github.com/bishabosha" class="bio-link" rel="me"><i class="fa-brands fa-github fa-lg"></i><br />GitHub</a></small></p></li><li class="list-inline-item"><p class="text-center mb-1"><small><a href="https://twitter.com/bishabosha" class="bio-link" rel="me"><i class="fa-brands fa-twitter fa-lg"></i><br />Twitter</a></small></p></li><li class="list-inline-item"><p class="text-center mb-1"><small><a href="https://www.linkedin.com/in/james-richard-thompson/" class="bio-link" rel="me"><i class="fa-brands fa-linkedin fa-lg"></i><br />LinkedIn</a></small></p></li><li class="list-inline-item"><p class="text-center mb-1"><small><a href="https://fosstodon.org/@jrthompson" class="bio-link" rel="me"><i class="fa-brands fa-mastodon fa-lg"></i><br />Mastodon</a></small></p></li><li class="list-inline-item"><p class="text-center mb-1"><small><a href="/static/pages/generalJamesThompsonresume2024.html" class="bio-link"><i class="fa-solid fa-file fa-lg"></i><br />Resume</a></small></p></li></ul><div class="d-none d-sm-none d-lg-block"><hr /><div class="bio-body bio-expand" tabindex="0"><p>Freelancing, previously hacking compilers at the <a href="https://scala.epfl.ch" target="_blank">Scala Center</a>.</p>
<p>I love to share ideas about programming, whether it is though speaking,
producing video tutorials, or engaging in the learning process to deliver the best materials for newcomers.</p>
<p>As a software engineer, my passions are programming language design, and simplifying APIs.</p>
</div></div></div></div><div class="sticky-top top-aligned jumbotron sidebar shadow py-lg-4 py-3"><nav class="toc-nav"><ol class="list-unstyled"><li class="toc-level-1"><a href="#how-to-write-a-website-generator-in-scala-part-1.html">How to write a website generator in Scala, Part 1</a></li><li class="toc-level-2"><a href="#requirements">Requirements</a></li><li class="toc-level-2"><a href="#a-basic-implementation">A Basic Implementation</a></li><li class="toc-level-2"><a href="#getting-started">Getting Started</a></li><li class="toc-level-2"><a href="#filling-in-the-details">Filling in the Details</a></li><li class="toc-level-2"><a href="#next-steps">Next Steps</a></li><li class="toc-level-2"><a href="#conclusion">Conclusion</a></li></ol></nav></div></div><div class="col-lg-8"><div class="jumbotron bg-light py-lg-5 py-3"><article><h1 id="how-to-write-a-website-generator-in-scala-part-1.html" class="display-5 anchor-link__source">How to write a website generator in Scala, Part 1</h1><ul class="list-inline mb-2"><li class="list-inline-item"><small><span class="text-muted">Monday, 1 August 2022</span></small></li><li class="list-inline-item"><small><i class="fa-solid fa-hourglass-start"></i> 4 minute read</small></li><li class="list-inline-item"><small><a href="/articles/"><i class="fa-solid fa-angle-up"></i> all articles</a></small></li></ul><hr /><div class="container mb-2"><div class="row"><div class="col d-flex"></div><div class="col d-flex flex-row-reverse"><small class="float-end"><a href="/articles/simple-parsing-with-strings.html">Enhanced Simple Parsing for Scala <i class="fa-solid fa-angle-right"></i></a></small></div></div></div><div><p>I decided to write my own website generator to build my personal website.
My goal was to use Markdown to drive the content, and use Scala to make templating the HTML easier.
Read on for how you can do it yourself.</p>
<p>To help build the website I used a new tool <a href="https://scala-cli.virtuslab.org">Scala CLI</a>.
It's a great aid for rapid prototyping of Scala code, making adding dependencies and other configuration simple.
I also used <a href="https://code.visualstudio.com">VS Code</a> with the <a href="https://scalameta.org/metals/">Metals</a> extension to get IDE features when writing the code.</p>
<h2><a href="#requirements" id="requirements" class="anchor-link anchor-link__source"><i class="fa-solid fa-link"></i></a>Requirements</h2>
<p>The key idea behind the site-generator should be simplicity: low on configuration, driven by markdown files that are expanded via templates, which wrap the markdown content in further HTML. I wanted a very flexible template language for generating websites, so I chose <a href="https://www.scala-lang.org">Scala 3</a>.</p>
<p>The user of the framework should see the directory structure as a single type-safe object, with access to the metadata and contents of each markdown file.</p>
<p>Some markdown files will just act as data, visible to all the pages, but if it declares a template in its front-matter, then it will be published to a page with a dedicated URL. A declared template will be resolved to a Scala function.
That function will recieve the markdown file's metadata and content, and also see the database of all other markdown-derived data.</p>
<h2><a href="#a-basic-implementation" id="a-basic-implementation" class="anchor-link anchor-link__source"><i class="fa-solid fa-link"></i></a>A Basic Implementation</h2>
<p>To begin I followed the guide to build a basic static website generator from <a href="https://www.handsonscala.com">Hands-on Scala Programming</a> by <a href="https://www.lihaoyi.com">Li Haoyi</a>. I would recommend this book for beginners looking to get to speed with Scala: It shows how to build a number of practical projects using Scala libraries that are very accessible.</p>
<p>Chapters 9 and 10 of the book have the reader incrementally develop a script to generate a static blog website, with an index page of all articles, and an individual page per article.</p>
<p>I chose to embellish the process described in the book, with the goal to eventually build the framework for the static site generator described in the previous section.</p>
<h2><a href="#getting-started" id="getting-started" class="anchor-link anchor-link__source"><i class="fa-solid fa-link"></i></a>Getting Started</h2>
<p>Instead of using <a href="https://ammonite.io">ammonite</a> as <em>Hands-on Scala</em> suggests, I opted to drive development with <a href="https://scala-cli.virtuslab.org">Scala CLI</a>, giving me the most flexibility to prototype and grow the website generator.</p>
<p>To begin, I opened a blank file <code>site/makeSite.scala</code> and added the following:</p>
<pre><code class="language-scala">//&gt; using scala &quot;3.1.3&quot;
//&gt; using lib &quot;com.lihaoyi::os-lib:0.8.1&quot;
//&gt; using lib &quot;com.lihaoyi::scalatags:0.11.1&quot;

@main def makeSite = println(&quot;made site!&quot;)
</code></pre>
<p>To make sure everything is set up well, I ran the <code>site</code> directory with <code>scala-cli</code>, which detected the <code>makeSite</code> main method and executed it:</p>
<pre><code class="language-bash">$ scala-cli run site
Compiling project (Scala 3.1.3, JVM)
Compiled project (Scala 3.1.3, JVM)
made site!
</code></pre>
<p>This initialised the <code>site</code> directory as a <code>scala-cli</code> project, making it ready to open in VS Code and get IDE features from the Metals extension.</p>
<p>Now, with the help of Metals, the editor recognises the <code>makeSite</code> main method, which we can run from within the editor, and it also provides <em>code completions</em> for the library dependencies we declared at the top of the file, such as <code>os-lib</code>:</p>
<p><img src="../static/img/scala-cli-code-complete.png" class="img-fluid" alt="makeSite.scala opened in VS Code, code lenses on makeSite suggest to run the script. IDE completions also suggest to use 'Path' after typing 'os.Pa'" /></p>
<h2><a href="#filling-in-the-details" id="filling-in-the-details" class="anchor-link anchor-link__source"><i class="fa-solid fa-link"></i></a>Filling in the Details</h2>
<p>The next steps were to complete the basic implementation as detailed in the book.</p>
<p>I made a few changes to processing of files:</p>
<ul>
<li>Process markdown with <a href="https://github.com/vsch/flexmark-java">flexmark-java</a>, rather than commonmark-java. This gave me more flexibility, such as providing inline attributes for images in markdown.</li>
<li>I also use flexmark's front matter parser on markdown files, so I can use the metadata for driving templates.</li>
<li>Sample the word count for each article, to estimate read time.</li>
</ul>
<p>I also added a lot of templates for additional parts I required for this website:</p>
<ul>
<li>card views for displaying links and recent articles,</li>
<li>everything on the <a href="/">About</a> page</li>
<li>responsive sidebar,</li>
<li>website footer,</li>
<li>navbar,</li>
<li>previous/next links for individual articles,</li>
<li>displaying social links</li>
<li>reading publish date, titles and other metadata from markdown front-matter.</li>
</ul>
<p>Architecturally I made a few changes. For example, there is now a single source of truth for the directory root of markdown files. The book instead reads markdown files relative to the current working directory. This directory can change a lot depending on where the script is executed. e.g. a VS Code code lens executes from a different directory than when executing with <code>scala-cli</code> on the command line. Now, I discover the root directory at compiletime, by capturing the source-file that the main method was declared in.</p>
<h2><a href="#next-steps" id="next-steps" class="anchor-link anchor-link__source"><i class="fa-solid fa-link"></i></a>Next Steps</h2>
<p>To take the generator further I will try to generalise the implementation to make it flexible for many use cases with minimal configuration. I plan to experiment with a journal to exercise this. Then I intend to release the generalised solution as a downloadable seed project.</p>
<h2><a href="#conclusion" id="conclusion" class="anchor-link anchor-link__source"><i class="fa-solid fa-link"></i></a>Conclusion</h2>
<p>I had fun building this site, learning a few things about <a href="https://getbootstrap.com">Bootstrap</a> in the process. I would also like to emphasise how much help <code>scala-cli</code> was in keeping me motivated to reach this milestone of a proper personal website, featuring a first written article.</p>
</div><div class="container mb-2"><div class="row"><div class="col d-flex"></div><div class="col d-flex flex-row-reverse"><small class="float-end"><a href="/articles/simple-parsing-with-strings.html">Enhanced Simple Parsing for Scala <i class="fa-solid fa-angle-right"></i></a></small></div></div></div></article></div></div></div></div><footer class="mt-auto"><div class="footer-copyright text-center py-3"><small>Â© 2024 Jamie Thompson.<span class="text-muted"> Last published 27/Sep/2024</span></small></div></footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script><script src="/static/js/nav-toc.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js" type="text/javascript"></script><script src="/static/js/hljs-scala3.js" type="text/javascript"></script><script src="/static/js/hljs.js" type="text/javascript"></script><script src="/static/js/katex-render.js" type="text/javascript"></script><script src="/static/js/admonition.js" type="text/javascript"></script></body></html>